<!DOCTYPE html>
<html lang="en">
<head>
  <!-- GTM (leave as-is) -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WW7VC75G');</script>

  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Shopping Cart - LoveMeNow</title>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>

  <!-- Site CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}?v=20250116-2"/>

  <!-- Mobile Optimizations CSS -->
  <link rel="preload" href="{{ url_for('static', filename='CSS/mobile-optimizations.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ url_for('static', filename='CSS/mobile-optimizations.css') }}"></noscript>

  <!-- CSRF -->
  {% include 'csrf_meta.html' %}

  <!-- Google AdWords / GTM -->
  {% include 'google_tag.html' %}

  <style>
    .cart-container{max-width:1200px;margin:2rem auto;padding:0 1rem}
    .cart-header{text-align:center;margin-bottom:3rem}
    .cart-header h1{font-size:2.5rem;margin-bottom:.5rem;background:linear-gradient(135deg,hsl(var(--primary-color)),hsl(var(--accent-color)));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .cart-content{display:grid;grid-template-columns:1fr 400px;gap:3rem;align-items:start}
    .cart-items{background:hsl(var(--surface-color));border-radius:var(--radius-lg);padding:2rem}
    .cart-item{display:grid;grid-template-columns:80px 1fr auto auto auto;gap:1rem;align-items:center;padding:1.5rem 0;border-bottom:1px solid hsl(var(--border-color))}
    .cart-item:last-child{border-bottom:none}
    .cart-item-image{width:80px;height:80px;border-radius:var(--radius-md);overflow:hidden}
    .cart-item-image img{width:100%;height:100%;object-fit:contain;}
    .cart-item-details{display:flex;flex-direction:column}
    .cart-item-details h3{margin:0 0 .5rem 0;font-size:1.1rem}
    .cart-item-size{font-size:.9rem;color:hsl(var(--muted-color));margin-bottom:.5rem}
    .cart-item-price{font-weight:600;color:hsl(var(--primary-color))}
    .quantity-controls{display:flex;flex-direction:column;align-items:center;gap:.5rem}
    .quantity-input{width:50px;height:32px;text-align:center;background:hsl(var(--surface-color));border:1px solid hsl(var(--border-color));border-radius:var(--radius-sm);color:hsl(var(--text-color));font-weight:600;font-size:.95rem}
    .quantity-input:focus{outline:none;border-color:hsl(var(--primary-color))}
    .quantity-buttons{display:flex;gap:.5rem}
    .quantity-btn{width:32px;height:28px;border:none;background:hsl(var(--border-color));color:hsl(var(--text-color));border-radius:var(--radius-sm);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease;font-size:.8rem}
    .quantity-btn:hover:not(:disabled){background:hsl(var(--primary-color));color:#fff}
    .quantity-btn:disabled{opacity:.5;cursor:not-allowed;background:hsl(var(--border-color))}
    .cart-item-total{font-weight:600;font-size:1.1rem}
    .remove-btn{background:none;border:none;color:hsl(var(--muted-color));cursor:pointer;padding:.5rem;border-radius:var(--radius-sm);transition:all .2s ease}
    .remove-btn:hover{color:#ff4757;background:rgba(255,71,87,.1)}
    .cart-summary{background:hsl(var(--surface-color));border-radius:var(--radius-lg);padding:2rem;height:fit-content;position:sticky;top:2rem}
    .summary-row{display:flex;justify-content:space-between;margin-bottom:1rem;padding-bottom:1rem}
    .summary-row.total{border-top:1px solid hsl(var(--border-color));padding-top:1rem;font-weight:600;font-size:1.2rem}
    .checkout-btn{width:100%;padding:1rem;background:linear-gradient(135deg,hsl(var(--primary-color)),hsl(var(--accent-color)));color:#fff;border:none;border-radius:var(--radius-md);font-weight:600;font-size:1.1rem;cursor:pointer;transition:all .2s ease;margin-top:1rem}
    .checkout-btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
    .empty-cart{text-align:center;padding:4rem 2rem;color:hsl(var(--muted-color))}
    .empty-cart i{font-size:4rem;margin-bottom:1rem;opacity:.5}
    .continue-shopping{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:hsl(var(--border-color));color:hsl(var(--text-color));text-decoration:none;border-radius:var(--radius-md);transition:all .2s ease;margin-top:1rem}
    .continue-shopping:hover{background:hsl(var(--primary-color));transform:translateY(-2px)}
    .discount-code-section{margin:1.5rem 0;padding:1.5rem 0;border-top:1px solid hsl(var(--border-color));border-bottom:1px solid hsl(var(--border-color))}
    .discount-label{color:hsl(var(--muted-color));font-size:.9rem;margin-bottom:.75rem;font-weight:500}
    .discount-form{width:100%}
    .discount-input-group{display:flex;gap:.5rem;width:100%}
    .discount-input{flex:1;padding:.75rem 1rem;background:rgba(255,255,255,.05);border:2px solid rgba(168,85,247,.2);border-radius:var(--radius-md);color:hsl(var(--text-color));font-size:.9rem;transition:all .3s ease;outline:none}
    .discount-input:focus{border-color:hsl(var(--primary-color));background:rgba(255,255,255,.08);box-shadow:0 0 0 4px rgba(168,85,247,.1)}
    .discount-input::placeholder{color:hsl(var(--muted-color))}
    .discount-submit-btn{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:linear-gradient(135deg,hsl(var(--primary-color)),hsl(var(--accent-color)));color:#fff;border:none;border-radius:var(--radius-md);font-weight:600;font-size:.9rem;cursor:pointer;transition:all .2s ease;outline:none;white-space:nowrap}
    .discount-submit-btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}
    .discount-submit-btn:focus,.discount-submit-btn:active{border:none;outline:none;box-shadow:var(--shadow-lg)}
    @media (max-width:768px){
      .cart-content{grid-template-columns:1fr;gap:2rem}
      .cart-item{grid-template-columns:60px 1fr;gap:1rem}
      .cart-item-controls{grid-column:1 / -1;display:flex;justify-content:space-between;align-items:center;margin-top:1rem}
      .discount-input-group{flex-direction:column}
      .discount-submit-btn{width:100%;justify-content:center}
    }
  </style>
</head>
<body>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WW7VC75G"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

  {% include "navbar.html" %}

  <div class="cart-container">
    <div class="cart-header">
      <h1>Shopping Cart</h1>
      <p>Review your items before checkout</p>
    </div>

    <div id="cartContent"><!-- rendered by cart.js --></div>
  </div>

  <!-- Modals -->
  {% include 'login_register_modal.html' %}
  {% include 'logged_in_modal.html' %}
  {% include 'wishlist_modal.html' %}

  <!-- JS: helpers, csrf, then cart (NO discount.js here) -->
  <script src="{{ url_for('static', filename='js/index.js') }}?v=20250116-3" defer></script>
  <script src="{{ url_for('static', filename='js/csrf-handler.js') }}" defer></script>
  <script src="{{ url_for('static', filename='js/discount.js') }}?v=20251001-4" defer></script>

  <script src="{{ url_for('static', filename='js/cart.js') }}?v=20251001-1" defer></script>
  <script src="{{ url_for('static', filename='js/mobile-menu.js') }}" defer></script>
</body>
</html>
