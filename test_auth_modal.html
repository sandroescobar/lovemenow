<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Auth Modal</title>
    <link rel="stylesheet" href="static/CSS/auth-modal.css" />
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .test-button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Auth Modal Test</h1>
    <p>Click the buttons below to test the modal functionality:</p>
    
    <button class="test-button" onclick="openAuthModal('login')">Open Login Modal</button>
    <button class="test-button" onclick="openAuthModal('register')">Open Register Modal</button>
    <button class="test-button" onclick="closeAuthModal()">Close Modal</button>
    
    <div id="status"></div>

    <!-- Include the modal -->
    <!-- ================= AUTH MODAL OVERLAY ================= -->
    <div class="auth-overlay" id="authOverlay" role="dialog" aria-modal="true" aria-labelledby="authModalTitle" hidden>
        <div class="auth-modal">
            <button type="button" class="auth-close" aria-label="Close" data-close-auth>&times;</button>

            <div class="auth-panels">
                <!-- Login Panel (LEFT SIDE) -->
                <section class="auth-panel login-panel" aria-labelledby="loginTitle">
                    <h2 id="loginTitle" class="auth-title">Login</h2>
                    <p class="auth-desc">Welcome back! Please sign in to your account.</p>

                    <form class="auth-form" id="loginForm" method="post" action="#">
                        <div class="auth-field with-indicator">
                            <label for="loginEmail">Email Address</label>
                            <input type="email" id="loginEmail" name="email" autocomplete="email" required />
                            <span class="field-indicator" aria-hidden="true"></span>
                        </div>

                        <div class="auth-field with-indicator">
                            <label for="loginPassword">Password</label>
                            <input type="password" id="loginPassword" name="password" autocomplete="current-password" required />
                            <span class="field-indicator" aria-hidden="true"></span>
                        </div>

                        <button class="auth-btn ghost" type="submit">Login</button>
                    </form>
                </section>

                <!-- Register Panel (RIGHT SIDE) -->
                <section class="auth-panel register-panel" aria-labelledby="registerTitle">
                    <h2 id="registerTitle" class="auth-title">Register</h2>
                    <p class="auth-desc">Create your account to start shopping with us.</p>

                    <form class="auth-form" id="registerForm" method="post" action="#">
                        <div class="auth-field-group two-col">
                            <div class="auth-field">
                                <label for="regFirst">First Name</label>
                                <input type="text" id="regFirst" name="first_name" required />
                            </div>
                            <div class="auth-field">
                                <label for="regLast">Last Name</label>
                                <input type="text" id="regLast" name="last_name" required />
                            </div>
                        </div>

                        <div class="auth-field">
                            <label for="regEmail">Email Address</label>
                            <input type="email" id="regEmail" name="email" autocomplete="email" required />
                        </div>

                        <div class="auth-field">
                            <label for="regPassword">Password</label>
                            <input type="password" id="regPassword" name="password" autocomplete="new-password" required />
                        </div>

                        <div class="auth-field">
                            <label for="regPassword2">Verify Password</label>
                            <input type="password" id="regPassword2" name="password_confirm" autocomplete="new-password" required />
                        </div>

                        <button class="auth-btn primary" type="submit">Register</button>
                    </form>
                </section>
            </div> <!-- /.auth-panels -->

        </div> <!-- /.auth-modal -->
    </div> <!-- /.auth-overlay -->

    <script>
        // Auth modal functions
        window.openAuthModal = function (mode = 'login') {
            console.log('üî• openAuthModal called with mode:', mode);
            const overlay = document.getElementById('authOverlay');
            console.log('üîç Modal element found:', overlay);
            if (!overlay) {
                console.error('‚ùå Auth overlay not found in DOM!');
                document.getElementById('status').innerHTML = '<p style="color: red;">‚ùå Auth overlay not found in DOM!</p>';
                return;
            }

            // Show the modal
            overlay.hidden = false;
            document.body.classList.add('no-scroll');
            
            // Focus the appropriate field based on mode
            const firstInput = mode === 'register' ? 
                overlay.querySelector('#regFirst') : 
                overlay.querySelector('#loginEmail');
            if (firstInput) firstInput.focus();
            
            document.getElementById('status').innerHTML = '<p style="color: green;">‚úÖ Modal opened successfully!</p>';
        };

        window.closeAuthModal = function () {
            console.log('üîí Closing auth modal');
            const overlay = document.getElementById('authOverlay');
            if (!overlay) {
                document.getElementById('status').innerHTML = '<p style="color: red;">‚ùå Auth overlay not found in DOM!</p>';
                return;
            }

            overlay.hidden = true;
            document.body.classList.remove('no-scroll');

            // Reset forms
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            if (loginForm) loginForm.reset();
            if (registerForm) registerForm.reset();
            
            document.getElementById('status').innerHTML = '<p style="color: blue;">üîí Modal closed successfully!</p>';
        };

        // Event listeners for the auth modal
        document.addEventListener('click', (e) => {
            const overlay = document.getElementById('authOverlay');
            if (!overlay) return;
            
            if (e.target.matches('[data-close-auth]')) {
                window.closeAuthModal();
            } else if (e.target === overlay) { // click outside modal
                window.closeAuthModal();
            }
        });

        // Escape key closes
        document.addEventListener('keydown', (e) => {
            const overlay = document.getElementById('authOverlay');
            if (e.key === 'Escape' && overlay && !overlay.hidden) {
                window.closeAuthModal();
            }
        });

        // Test on page load
        document.addEventListener('DOMContentLoaded', function() {
            const overlay = document.getElementById('authOverlay');
            if (overlay) {
                const isHidden = overlay.hidden;
                const computedDisplay = getComputedStyle(overlay).display;
                document.getElementById('status').innerHTML = 
                    `<p>Modal Status: Hidden=${isHidden}, Display=${computedDisplay}</p>`;
            }
        });
    </script>
</body>
</html>